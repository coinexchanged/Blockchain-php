layui.config({base:"../../lib/",version:"1.0.0-beta"}).extend({winui:"winui/winui",window:"winui/js/winui.window"}).define(["table","jquery","winui","window","layer"],function(n){function f(n){if(n){var r,u=layer.load(1);t.ajax({type:"get",url:"edit.html?id="+n,success:function(n){layer.close(u);r=n;top.winui.window.open({id:"editMenu",type:1,title:"编辑菜单",content:r,area:["50vw","70vh"],offset:["15vh","25vw"]})},error:function(n){layer.close(u);i("获取页面失败",{icon:2,time:2e3});console.log(n.responseText)}})}}function e(n,t){var i=t?"确认删除菜单【"+t.data.name+"】吗？":"确认删除选中数据吗？";top.winui.window.confirm(i,{icon:3,title:"删除系统菜单"},function(n){layer.close(n);i("删除成功",{icon:1,time:2e3});t?t.del():o()})}function o(){r.reload(u,{})}winui.renderColor();var r=layui.table,t=layui.$,u="tableid",i=top.winui.window.msg;r.render({id:u,elem:"#menu",url:"../../json/menulist.json",page:!0,limits:[10,20,30,40,50,60,70,100],limit:10,cols:[[{field:"id",type:"checkbox"},{field:"icon",title:"图标",width:120},{field:"name",title:"名称",width:150},{field:"title",title:"标题",width:150},{field:"pageURL",title:"页面地址",width:200},{field:"openType",title:"页面类型",width:120,templet:"#openTypeTpl"},{field:"isNecessary",title:"系统菜单",width:100,templet:"#isNecessary"},{field:"order",title:"排序",width:80,edit:"text"},{title:"操作",fixed:"right",align:"center",toolbar:"#barMenu",width:200}]]});r.on("tool(menutable)",function(n){var r=n.data,u=n.event,s=n.tr,o="";t(r).each(function(n,t){o+=t.id+","});u==="del"?e(o,n):u==="edit"?f(r.id):u==="setting"&&t.ajax({type:"get",url:"setting.html?menuId="+r.id,async:!1,success:function(n){content=n;top.winui.window.open({id:"settingMenu",type:1,title:"权限设置",content:content,area:["55vw","70vh"],offset:["15vh","25vw"]})},error:function(n){i("获取页面失败",{icon:2,time:2e3});console.log(n.responseText)}})});r.on("edit(menutable)",function(n){if(/^[0-9]+$/.test(n.value)){var r=layer.load(1);t.ajax({type:"post",url:"views/menu/updatemenuorder",data:{id:n.data.id,order:n.value},success:function(n){layer.close(r);n.isSucceed||i(n.message)},error:function(n){layer.close(r);i("修改失败",{icon:2,time:2e3});console.log(n.responseText)}})}});t("#addMenu").on("click",function(){var n,r=layer.load(1);t.ajax({type:"get",url:"add.html",success:function(t){layer.close(r);n=t;top.winui.window.open({id:"addMenu",type:1,title:"新增菜单",content:n,area:["50vw","70vh"],offset:["15vh","25vw"]})},error:function(n){layer.close(load);i("操作失败",{icon:2,time:2e3});console.error(n.responseText)}})});t("#editMenu").on("click",function(){var n=r.checkStatus(u),t=n.data.length;if(t<1)return i("请选择一条数据",{time:2e3}),!1;if(t>1)return i("只能选择一条数据",{time:2e3}),!1;f(n.data[0].id)});t("#deleteMenu").on("click",function(){var f=r.checkStatus(u),o=f.data.length,n;if(o<1)return i("请选择一条数据",{time:2e3}),!1;n="";t(f.data).each(function(t,i){n+=i.id+","});e(n)});t("#reloadTable").on("click",o);n("menulist",{})});