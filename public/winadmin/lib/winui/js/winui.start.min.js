/**
 @Name：winui.start 开始菜单模块
 @Author：Leo
 @License：MIT
    
 */
layui.define(["jquery","element","layer","winui"],function(n){"use strict";var t=layui.jquery,f=layui.element,r=function(n){this.options=n||{url:winui.path+"json/allmenu.json",method:"get"};this.data=null},i;r.prototype.render=function(n){if(this.data!==null){var i="";t(this.data).each(function(n,r){var u=r.id==""||r.id==undefined?"":'win-id="'+r.id+'"',f=r.pageURL==""||r.pageURL==undefined?"":'win-url="'+r.pageURL+'"',e=r.title==""||r.title==undefined?"":'win-title="'+r.title+'"',o=r.openType==""||r.openType==undefined?"":'win-opentype="'+r.openType+'"',s=r.maxOpen==""||r.maxOpen==undefined?"":'win-maxopen="'+r.maxOpen+'"',h=r.icon==""||r.icon==undefined?"":'win-icon="'+r.icon+'"',c=r.extend?" layui-nav-itemed":"",l=r.childs?" parent":"",a=r.icon.indexOf("fa-")!=-1&&r.icon.indexOf(".")==-1?'<i class="fa '+r.icon+' fa-fw"><\/i>':'<img src="'+r.icon+'" />';i+='<li class="layui-nav-item '+l+" "+c+'" '+u+" "+f+" "+e+" "+o+" "+s+" "+h+">";i+='<a><div class="winui-menu-icon">';i+=a;i+="<\/div>";i+='<span class="winui-menu-name">'+r.name+"<\/span><\/a>";r.childs&&(i+='<dl class="layui-nav-child">',t(r.childs).each(function(n,t){var r=t.id==""||t.id==undefined?"":'win-id="'+t.id+'"',u=t.pageURL==""||t.pageURL==undefined?"":'win-url="'+t.pageURL+'"',f=t.title==""||t.title==undefined?"":'win-title="'+t.title+'"',e=t.openType==""||t.openType==undefined?"":'win-opentype="'+t.openType+'"',o=t.maxOpen==""||t.maxOpen==undefined?"":'win-maxopen="'+t.maxOpen+'"',s=t.icon==""||t.icon==undefined?"":'win-icon="'+t.icon+'"',h=t.icon.indexOf("fa-")!=-1&&t.icon.indexOf(".")==-1?'<i class="fa '+t.icon+' fa-fw"><\/i>':'<img src="'+t.icon+'" />';i+="<dd "+r+" "+u+" "+f+" "+e+" "+o+" "+s+">";i+='<a><div class="winui-menu-icon">';i+=h;i+="<\/div>";i+='<span class="winui-menu-name">'+t.name+"<\/span><\/a>"}),i+="<\/dl>");i+="<\/li>"});t(".winui-menu").html(i);layui.element.init("nav","winuimenu");typeof n=="function"&&n.call(this,e)}};r.prototype.setData=function(n){var i=this,r=i.options;r.url&&r.method&&t.ajax({url:r.url,type:r.method,data:t.extend({},r.data),dataType:"json",success:function(t){t=t.data;typeof t=="string"?(i.data=JSON.parse(t),typeof n=="function"&&n.call(i)):typeof t=="object"&&(Object.prototype.toString.call(t).toLowerCase()=="[object object]"||Object.prototype.toString.call(t).toLowerCase()=="[object array]")?(i.data=t,typeof n=="function"&&n.call(i)):layer.msg("请对接口返回json对象或者json字符串",{offset:"40px",zIndex:layer.zIndex})},error:function(n){n.status!=200?console.error(n.statusText):layer.msg("请对接口返回json对象或者json字符串",{offset:"40px",zIndex:layer.zIndex})}})};i=function(){this.contextmenuOptions={}};i.prototype.onclick=function(n){f.on("nav(winuimenu)",n)};i.prototype.contextmenu=function(n){n.item&&(o.resetEvent(".winui-menu li:not(.parent),.winui-menu dd","mouseup",function(i){var r;if(i||(i=window.event),r=this,i.button==2){var f=i.clientX,e=i.clientY,u='<ul class="menu-contextmenu" style="top:'+e+"px;left:"+f+'px;">';t(n.item).each(function(n,t){var i=t.icon?'<i class="fa '+t.icon+' fa-fw"><\/i>':"";u+="<li>"+i+t.text+"<\/li>"});u+="<\/ul>";t(".menu-contextmenu").remove();t("body").append(u);t("ul.menu-contextmenu li").on("click",function(){var i=t(this).index();typeof n["item"+(i+1)]=="function"&&(n["item"+(i+1)].call(this,t(r).attr("win-id"),t(r)),t(".menu-contextmenu").remove())});t(".menu-contextmenu li").on("click mousedown",s.sp)}}),this.contextmenuOptions=n)};var e=new i,o={resetEvent:function(n,i,r){if(typeof r=="function")t(n).off(i).on(i,r)}},s={sp:function(n){layui.stope(n)}},u=new r;u.config=function(n){n=n||{};for(var t in n)this.options[t]=n[t];return this};u.init=function(n,t){typeof n=="object"?this.config(n):typeof n=="fuction"&&(t=n);this.done=t=t||this.done;this.setData(function(){this.render(t)})};winui.menu=u;n("start",{});delete layui.start});