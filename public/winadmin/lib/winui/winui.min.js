/*!
 @Title: Winui
 @Description：Win10风格前端模板
 @Site: www.win-ui.com
 @Author: Leo
 @License：MIT
 */
!function(){"use strict";var n="winui-this",t="layui-show",i="winui",r=40,e=function(){var n=document,t=n.currentScript?n.currentScript.src:function(){for(var t=n.scripts,r=t.length-1,u,i=r;i>0;i--)if(t[i].readyState==="interactive"){u=t[i].src;break}return u||t[r].src}();return t.substring(0,t.lastIndexOf("/")+1)}(),u=typeof HTMLElement=="object"?function(n){return n instanceof HTMLElement}:function(n){return n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"},f=function(n){return n instanceof $};layui.define(["jquery","layer","element","form"],function(o){var s=layui.jquery,a=layui.form,v={data:null,setData:function(n){h.setData(this,"/json/tile-item.json",n)}},y={on:function(n,t){c.on("taskItem("+n+")",t)}},p={init:function(){h.resetClick(".winui-tab-nav li",function(){var n=s(this),t=t||n.parent().children("li").index(n),r=n.parents(".winui-tab").eq(0),u=r.find(".winui-tab-content").children(".winui-tab-item"),f=r.attr("lay-filter");h.selectDom(this);h.showDom(u.eq(t));layui.event.call(n[0],i,"tabchange("+f+")",{index:t,elem:r})})},on:function(n,t){return layui.onevent.call(this,i,n,t)}},l=function(){this.v="1.0.0";this.path=e;this.settings=layui.data("winui").settings||{color:31,taskbarMode:"bottom",bgSrc:"images/bg_01.jpg",lockBgSrc:"images/bg_01.jpg",audioSrc:this.path+"audio/236",startSize:"sm"};this.configs={};this.event={};this.verify={required:[/[\S]+/,"必填项不能为空"],phone:[/^1\d{10}$/,"请输入正确的手机号"],email:[/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,"邮箱格式不正确"],url:[/(^#)|(^http(s*):\/\/[^\s]+\.[^\s]+)/,"链接格式不正确"],number:[/^\d+$/,"只能填写数字"],date:[/^(\d{4})[-\/](\d{1}|0\d{1}|1[0-2])([-\/](\d{1}|0\d{1}|[1-2][0-9]|3[0-1]))*$/,"日期格式不正确"],identity:[/(^\d{15}$)|(^\d{17}(x|X|\d)$)/,"请输入正确的身份证号"]};this.tile=v;this.taskItem=y;this.tab=p},h,c;l.prototype={config:function(n){var i,t;n=n||{};i={};for(t in n){if(t==="settings"){i=n[t];continue}this.configs[t]=n[t]}for(t in i)this.settings[t]=i[t];return this},init:function(t,i){var r=this,f=r.configs,o=r.settings,t=t||{},u,e;t.renderBg&&r.renderBg();t.audioPlay&&!layui.sessionData("winuiSession").audio&&(u=document.createElement("audio"),e=undefined,u.onended=function(){u=null},u.canPlayType("audio/mp3")?e=".mp3":u.canPlayType("audio/ogg")&&(e=".wav"),e&&(u.src=o.audioSrc+e,u.play(),layui.sessionData("winuiSession",{key:"audio",value:!0})));r.renderTaskbar();r.renderStartSize();r.renderColor();r.desktop&&f.desktop&&r.desktop.init(f.desktop.options,f.desktop.done);r.menu&&f.menu&&r.menu.init(f.menu.options,f.menu.done);r.tab.init();s(document).mousedown(function(){s(".task-contextmenu,.menu-contextmenu,.app-contextmenu").remove();s(".winui-start").addClass("layui-hide");s(".winui-console").removeClass("slideInRight").addClass("slideOutRight");s(".winui-taskbar-start,.winui-taskbar-console").removeClass(n);s(".winui-desktop>.winui-desktop-item").removeClass("winui-this")});s(".winui-start").mousedown(function(){s(".task-contextmenu,.menu-contextmenu,.app-contextmenu").remove()});s(document).on("keyup",function(n){n.keyCode===18&&s(".winui-taskbar-start").trigger("click")});h.resetClick(".winui-taskbar-start",c.startClick);h.resetMouseover(".winui-start-left>.winui-start-item",c.startLeftBtnMouseover);h.resetMouseout(".winui-start-left>.winui-start-item",c.startLeftBtnMouseout);h.resetClick(".winui-taskbar-console",c.consoleClick);h.resetClick(".winui-console .extend-switch",c.consoleExtendClick);h.resetClick(".winui-taskbar-desktop",c.desktopClick);r.sysTime(".winui-taskbar-time","<p>!HH:!mm<\/p><p>!yyyy-!M-!d<\/p>");s(window).on("resize",h.locaApp);typeof i=="function"&&i.call(r)},resetColor:function(n){n&&(this.settings.color=n,layui.data("winui",{key:"settings",value:this.settings}));this.renderColor();for(var t=0;t<window.frames.length;t++)window.frames[t].winui&&(window.frames[t].winui.settings.color=n,window.frames[t].winui.renderColor())},renderColor:function(){this.settings.color&&(s("body").attr("class")&&s("body").attr("class",s("body").attr("class").replace(/\bwinui-color.*?\b/g,"").replace(/(^\s*)|(\s*$)/g,"")),s("body").addClass("winui-color"+this.settings.color))},resetTaskbar:function(n){if(n){if(this.settings.taskbarMode===n)return;this.settings.taskbarMode=n;layui.data("winui",{key:"settings",value:this.settings})}this.renderTaskbar();n&&this.taskbarChange()},renderTaskbar:function(){s("body").attr("class")&&s("body").attr("class",s("body").attr("class").replace(/\btaskbarIn.*?\b/g,"").replace(/(^\s*)|(\s*$)/g,""));switch(this.settings.taskbarMode){case"top":s("body").addClass("taskbarInTop");break;case"bottom":s("body").addClass("taskbarInBottom");break;case"left":break;case"right":break;default:s("body").addClass("taskbarInBottom")}},resetStartSize:function(n){if(n){if(this.settings.startSize===n)return;this.settings.startSize=n;layui.data("winui",{key:"settings",value:this.settings});s(".preview-start").removeClass("xs sm lg");s(".preview-start").addClass(n)}this.renderStartSize()},renderStartSize:function(){s(".winui-start").attr("class")&&s(".winui-start").attr("class",s(".winui-start").attr("class").replace(/\winui-start-size.*?\b/g,"").replace(/(^\s*)|(\s*$)/g,""));switch(this.settings.startSize){case"xs":s(".winui-start").addClass("winui-start-size-xs");break;case"sm":s(".winui-start").addClass("winui-start-size-sm")}},resetBg:function(n){n&&(this.settings.bgSrc=n,layui.data("winui",{key:"settings",value:this.settings}));this.renderBg()},renderBg:function(){var n=this.settings.bgSrc;n&&s("body").css("background-image","url("+n+")")},resetLockBg:function(n){n&&(this.settings.lockBgSrc=n,layui.data("winui",{key:"settings",value:this.settings}))},fullScreen:function(n){var i=n.requestFullScreen||n.webkitRequestFullScreen||n.mozRequestFullScreen||n.msRequestFullScreen,t;i?i.call(n):typeof ActiveXObject!="undefined"&&(t=new ActiveXObject("WScript.Shell"),t!==null&&t.SendKeys("{F11}"))},exitFullScreen:function(){var t=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.webkitExitFullscreen,n;t?t.call(document):typeof ActiveXObject!="undefined"&&(n=new ActiveXObject("WScript.Shell"),n!==null&&n.SendKeys("{F11}"))},hideStartMenu:function(){s(".winui-start").addClass("layui-hide")},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},verifyForm:function(n){var n=s(n),i=null,r=layui.device(),u="layui-form-danger",f=n.parents(".layui-form"),e=f.find("*[win-verify]"),t=this,o=this.window;return layui.each(e,function(n,f){var e=s(this),l=e.attr("win-verify").split("|"),h="",c=e.val();return e.removeClass(u),layui.each(l,function(n,s){var l=typeof t.verify[s]=="function";if(t.verify[s]&&(l?h=t.verify[s](c,f):!t.verify[s][0].test(c)))return o.msg(h||t.verify[s][1],{icon:5,shift:6}),r.android||r.ios||f.focus(),e.addClass(u),i=!0}),i?i:void 0}),!i},sysTime:function(n,t){return setInterval(function(){var i=new Date,r=t;if(r!=undefined)r=r.replace(/!yyyy|!YYYY/,i.getFullYear()),r=r.replace(/!yy|!YY/,i.getYear()%100>9?(i.getYear()%100).toString():"0"+i.getYear()%100),r=r.replace(/!MM/,i.getMonth()+1>9?(i.getMonth()+1).toString():"0"+(i.getMonth()+1)),r=r.replace(/!M/g,i.getMonth()+1),r=r.replace(/!w|!W/g,["日","一","二","三","四","五","六"][i.getDay()]),r=r.replace(/!dd|!DD/,i.getDate()>9?i.getDate().toString():"0"+i.getDate()),r=r.replace(/!d|!D/g,i.getDate()),r=r.replace(/!hh|!HH/,i.getHours()>9?i.getHours().toString():"0"+i.getHours()),r=r.replace(/!h|!H/g,i.getHours()),r=r.replace(/!mm/,i.getMinutes()>9?i.getMinutes().toString():"0"+i.getMinutes()),r=r.replace(/!m/g,i.getMinutes()),r=r.replace(/!ss|!SS/,i.getSeconds()>9?i.getSeconds().toString():"0"+i.getSeconds()),r=r.replace(/!s|!S/g,i.getSeconds());else{var e=i.getFullYear(),o=i.getMonth()+1,h=i.getDate(),c=i.getHours(),u=i.getMinutes(),f=i.getSeconds();u=u<10?"0"+u:u;f=f<10?"0"+f:f;r=e+"-"+o+"-"+h+" "+c+":"+u+":"+f}s(n).html(r)},1e3)},stopSysTime:function(n){window.clearInterval(n)},taskAuto:function(){var n=!0;return s(".winui-taskbar-task").each(function(){var t=parseInt(s(this).prop("scrollWidth")),i=parseInt(s(this).children().length*165);if(t-165<i)return layer.msg("任务栏装不下啦",{zIndex:layer.zIndex}),n=!1,!1}),n},taskbarChange:function(){switch(this.settings.taskbarMode){case"top":s(".winui-window").css("top",function(n,t){s(this).css("top",Number(t.replace("px",""))+r+"px")});break;case"bottom":s(".winui-window").css("top",function(n,t){s(this).css("top",Number(t.replace("px",""))-r+"px")})}},getSetting:function(n){return this.settings[n]},lockScreen:function(n){var t=this;s(".winui-taskbar").css("zIndex","0");s.get(winui.path+"html/system/lockscreen.html",{},function(i){layer.open({id:"winui-lockscreen",type:1,title:!1,skin:"lockscreen",closeBtn:0,shade:0,anim:-1,isOutAnim:!1,zIndex:layer.zIndex,content:i,success:function(i,r){s(".lock-body").css("background-image","url("+t.settings.lockBgSrc+")");window.localStorage.setItem("lockscreen",!0);var e=winui.sysTime("#date_time",'<p id="time">!HH:!mm<\/p><p id="date">!M月!d日,星期!w<\/p>'),o=function(){winui.stopSysTime(e);s("#date_time").toggleClass("layui-hide");s("#login_div").toggleClass("layui-hide");s(document).off("mouseup",u);s(document).off(" keydown",f);s(document).on("keydown",function(n){var t=document.all?window.event:n;t.keyCode==27&&h()})},h=function(){e=winui.sysTime("#date_time",'<p id="time">!HH:!mm<\/p><p id="date">!M月!d日,星期!w<\/p>');s("#date_time").toggleClass("layui-hide");s("#login_div").toggleClass("layui-hide");s(document).off("keydown");s(document).on("mouseup",u);s(document).on("keydown",f)},u=function(n){n||(n=window.event);n.button==0&&o()},f=function(n){var t=document.all?window.event:n;t.keyCode==13&&o()};s(document).on("mouseup",u);s(document).on("keydown",f);a.on("submit(unlock)",function(t){try{typeof n=="function"&&n.call(this,t.field.password)&&(layer.close(r),window.localStorage.setItem("lockscreen",!1))}catch(i){return console.error(i),!1}return!1})}})})}};h={getWindowIdByWindow:function(n){return s(n).find(".layui-layer-content").prop("id")},getTaskItemByWindowDom:function(n){var t=h.getWindowIdByWindow(n);return h.getTaskItem(t)},getTaskItem:function(n){return typeof n=="string"?s(".winui-task-item[win-id="+n+"]")[0]:u(n)?n:f(n)?n[0]:null},getWindow:function(n){return typeof n=="string"?s(".winui-window:has(.layui-layer-content[id="+n+"])")[0]:u(n)?n:f(n)?n[0]:null},selectDom:function(t){s(t).addClass(n).siblings().removeClass(n)},showDom:function(n){s(n).addClass(t).siblings().removeClass(t)},addTaskItem:function(n,t){var i=s('<li win-id="'+n+'" class="winui-task-item">'+t+"<\/li>");return s(".winui-taskbar-task").append(i),i},resetClick:function(n,t){if(typeof t=="function")s(n).off("click").on("click",t)},resetMouseUp:function(n,t){if(typeof t=="function")s(n).off("mouseup").on("mouseup",t)},resetMouseover:function(n,t){if(typeof t=="function")s(n).off("mouseover").on("mouseover",t)},resetMouseout:function(n,t){if(typeof t=="function")s(n).off("mouseout").on("mouseout",t)},showWindow:function(n){s(h.getWindow(n)).removeClass("layui-hide")},hideWindow:function(n){s(h.getWindow(n)).addClass("layui-hide")},getTopWindow:function(){var n,t=0;return s(".winui-window:visible").each(function(){var i=s(this).css("z-index");i>t&&(n=this)}),n},isTopWindow:function(n){if(!s(n).is(":visible"))return!1;var i=s(n).css("z-index"),t=!0;return s(".winui-window:visible").each(function(){var n=s(this).css("z-index");if(n>i)return t=!1}),t},locaApp:function(){var u=96,f=90,i=parseInt(s(".winui-desktop").height()/93),t=0,n=0,r=0;s(".winui-desktop>.winui-desktop-item").each(function(e){var o=parseInt(e/i);r=parseInt(e/i);n=t==o?n:0;n==0&&t!=o&&t++;s(this).css("top",u*n+"px").css("left",f*r+"px");n++})},setData:function(n,t){var i=n.options;i.url&&i.method&&s.ajax({url:i.url,type:i.method,success:function(i){i=i.data;typeof i=="string"?(n.data=JSON.parse(i),typeof t=="function"&&t.call(this)):typeof i=="object"&&(Object.prototype.toString.call(i).toLowerCase()=="[object object]"||Object.prototype.toString.call(i).toLowerCase()=="[object array]")?(n.data=i,typeof t=="function"&&t.call(this)):layer.msg("请对接口返回json对象或者json字符串",{offset:"40px",zIndex:layer.zIndex})},error:function(n){n.status!=200?console.error(n.statusText):layer.msg("请对接口返回json对象或者json字符串",{offset:"40px",zIndex:layer.zIndex})}})}};c={on:function(n,t){typeof t=="function"&&(winui.event[n]=t)},sp:function(n){layui.stope(n)},startClick:function(){s(".task-contextmenu,.menu-contextmenu,.app-contextmenu").remove();s(this).toggleClass(n);s(".winui-start").toggleClass("layui-hide")},desktopClick:function(){s(".winui-window").addClass("layui-hide");s(".winui-task-item").removeClass(n)},consoleClick:function(){s(this).toggleClass(n);s(".winui-console").removeClass("layui-hide");s(".winui-console").toggleClass("slideInRight");s(".winui-console").toggleClass("slideOutRight")},consoleExtendClick:function(){s(this).text()==="展开"?(s(this).text("折叠"),s(this).parents(".winui-shortcut").addClass("extend"),s(this).parents(".winui-shortcut").siblings(".winui-message").css("bottom","330px")):(s(this).text("展开"),s(this).parents(".winui-shortcut").removeClass("extend"),s(this).parents(".winui-shortcut").siblings(".winui-message").css("bottom",""))},startLeftBtnMouseover:function(n){var r=s(n.currentTarget).attr("data-text"),t=n.clientX-20,u=n.clientY-50,i;t<0&&(t=0);i='<div class="leftbtnhovertext" style="top:'+u+"px;left:"+t+'px;">'+r+"<div>";s("body").append(i)},startLeftBtnMouseout:function(){s(".leftbtnhovertext").remove()}};s(document).off("contextmenu").on("contextmenu",function(){return!1});s(".sp").off("click mousedown").on("click mousedown",c.sp);window.winui=new l;winui.tab.init();o("winui",{});delete layui.winui})}(window);